webpackJsonp([1],{115:function(e,t){},116:function(e,t){},117:function(e,t){},118:function(e,t){},122:function(e,t,o){e.exports=o.p+"static/img/learnhub.b634cf5.png"},123:function(e,t,o){function n(e){o(115)}var i=o(11)(o(71),o(127),n,null,null);e.exports=i.exports},124:function(e,t,o){function n(e){o(116)}var i=o(11)(o(72),o(128),n,null,null);e.exports=i.exports},125:function(e,t,o){function n(e){o(118)}var i=o(11)(o(73),o(131),n,null,null);e.exports=i.exports},126:function(e,t,o){function n(e){o(117)}var i=o(11)(o(74),o(130),n,null,null);e.exports=i.exports},127:function(e,t,o){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"center-column"},[n("h1",[e._v("BKKHackmap")]),e._v(" "),n("a",{staticClass:"help-icon"},[e._v("?"),n("div",{staticClass:"help-text",domProps:{innerHTML:e._s(e.helpText)}})]),e._v(" "),e.username?n("a",{staticClass:"account-status",on:{click:e.logout}},[e._v(e._s(e.username)+" (Log out)")]):n("a",{staticClass:"account-status",on:{click:e.login}},[e._v("Log in")]),e._v(" "),n("div",{staticClass:"droptarget",on:{dragover:e.dragover,drop:e.drop}},[n("img",{staticClass:"floorplan",attrs:{src:o(122)}}),e._v(" "),e._l(e.projects,function(t){return t.x?n("img",{key:t.id,staticClass:"marker",class:{selected:e.selectedProject===t},style:{left:e.mapWidth*t.x-20+"px",top:e.mapHeight*t.y-20+"px"},attrs:{width:"36",draggable:t.username===e.username,"data-id":t.id,src:t.avatar_thumbnail,alt:t.username,title:t.title},on:{dragstart:e.drag,click:function(o){e.updateSelectedProject(t)}}}):e._e()})],2)])},staticRenderFns:[]}},128:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"appContainer"}},[o("left",{attrs:{form:e.form,projects:e.projects,selectedProject:e.selectedProject,username:e.username,isHasIssue:e.isHasIssue},on:{toggleForm:e.toggleForm,updateSelectedProject:e.updateSelectedProject,drag:e.leftDrag}}),e._v(" "),o("center",{attrs:{projects:e.projects,selectedProject:e.selectedProject,helpText:e.helpText,username:e.username,mapWidth:e.mapWidth,mapHeight:e.mapHeight},on:{updateSelectedProject:e.updateSelectedProject,login:e.login,logout:e.logout,drop:e.centerDrop}}),e._v(" "),o("right",{attrs:{selectedProject:e.selectedProject,username:e.username},on:{toggleEditMode:e.toggleEditMode,updateProject:e.updateProject,deleteProject:e.deleteProject}})],1)},staticRenderFns:[]}},129:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"app"}},[o("router-view")],1)},staticRenderFns:[]}},130:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"details side-column"},[e.selectedProject.id?[e.selectedProject.username===e.username?o("a",{staticClass:"edit-button",on:{click:e.toggleEditMode}},[e._v(e._s(e.selectedProject.editMode?"X":"Edit"))]):e._e(),e._v(" "),e.selectedProject.username===e.username?o("a",{staticClass:"delete-button",on:{click:function(t){e.deleteComment(e.selectedProject.id)}}},[e._v("Delete")]):e._e(),e._v(" "),o("img",{staticClass:"avatar",attrs:{src:e.selectedProject.avatar,alt:e.selectedProject.username,width:"122"}}),e._v(" "),o("p",[o("a",{attrs:{href:"https://github.com/"+e.selectedProject.username}},[e._v("@"+e._s(e.selectedProject.username))]),e._v(" is hacking on:")]),e._v(" "),e.selectedProject.editMode?[o("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedProject.title,expression:"selectedProject.title"}],attrs:{type:"text",autofocus:""},domProps:{value:e.selectedProject.title},on:{input:function(t){t.target.composing||e.$set(e.selectedProject,"title",t.target.value)}}}),e._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.selectedProject.description,expression:"selectedProject.description"}],domProps:{value:e.selectedProject.description},on:{input:function(t){t.target.composing||e.$set(e.selectedProject,"description",t.target.value)}}}),e._v(" "),o("button",{staticClass:"glow-button",on:{click:e.updateProject}},[e._v("Update")])]:[o("h2",[e._v(e._s(e.selectedProject.title))]),e._v(" "),o("p",{staticClass:"selected-project-description"},[e._v(e._s(e.selectedProject.description))])]]:e._e()],2)},staticRenderFns:[]}},131:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"projects side-column"},[o("div",{staticClass:"project-form",class:{open:e.form.isOpen}},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.form.title,expression:"form.title"}],attrs:{type:"text",placeholder:"Topic",autofocus:""},domProps:{value:e.form.title},on:{input:function(t){t.target.composing||e.$set(e.form,"title",t.target.value)}}}),e._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:e.form.description,expression:"form.description"}],attrs:{placeholder:"More description (optional)"},domProps:{value:e.form.description},on:{input:function(t){t.target.composing||e.$set(e.form,"description",t.target.value)}}})]),e._v(" "),e.isHasIssue?o("button",{staticClass:"glow-button disabled",attrs:{disabled:"true",title:"You already had a hack."},on:{click:e.toggleForm}},[e._v("+ Add your hack")]):o("button",{staticClass:"glow-button",on:{click:e.toggleForm}},[e._v("+ Add your hack")]),e._v(" "),e._l(e.projects,function(t){return o("div",{key:t.id,staticClass:"project",class:{selected:e.selectedProject===t},attrs:{"data-id":t.id,draggable:t.username===e.username},on:{dragstart:e.drag,click:function(o){e.updateSelectedProject(t)}}},[o("img",{attrs:{src:t.avatar_thumbnail,width:"36",alt:t.username,draggable:"false"}}),e._v("\n  "+e._s(t.title)+"\n  ")])}),e._v(" "),0===e.projects.length?o("div",{staticClass:"details"},[e._v("\n    No hacks yet! You can be first!\n  ")]):e._e(),e._v(" "),e.projects.loading?o("div",{staticClass:"loader"},[o("div",{staticClass:"loader1"}),e._v(" "),o("div",{staticClass:"loader2"}),e._v(" "),o("div",{staticClass:"loader3"})]):e._e()],2)},staticRenderFns:[]}},32:function(e,t,o){"use strict";var n=o(76),i=o.n(n),r=o(26),s=o.n(r),a=window.location.href.indexOf("index.html")>=0?window.location.href.replace("index.html","oauth_redirect.html"):window.location.href+"oauth_redirect.html",c="https://github.com/login/oauth/authorize?scope=public_repo&redirect_uri="+a+"&client_id=1b717d04ec7f3615bb18",u="https://bkkhackmap.herokuapp.com/authenticate/";s.a.options(u),t.a={isLoggedIn:function(){return!!window.localStorage.getItem("token")},logOut:function(){window.localStorage.removeItem("token")},getOAuthToken:function(){return new i.a(function(e,t){var o=window.localStorage.getItem("token");if(o)return void e(o);var n=window.open(c);window.addEventListener("oauth-code-received",function(o){var i=o.detail;s.a.get(u+i).then(function(t){window.localStorage.setItem("token",t.data.token),n.close(),e(t.data.token)}).catch(function(e){return t(e)})})})}}},48:function(e,t,o){"use strict";var n=o(25),i=o(132),r=o(124),s=o.n(r);n.a.use(i.a),t.a=new i.a({mode:"history",base:window.location.pathname,routes:[{path:"",name:"lastest",component:s.a},{path:":issueNumber",name:"history",component:s.a,props:!0}]})},49:function(e,t,o){var n=o(11)(o(70),o(129),null,null,null);e.exports=n.exports},67:function(e,t,o){"use strict";var n=o(77),i=o.n(n),r=o(78),s=o.n(r),a=o(26),c=o.n(a),u=o(68),d=o(32),l=function(){function e(t){var o=this;i()(this,e),this.config=t,this.github=this.createGithubApiClient(t.organization,t.repository),d.a.isLoggedIn()&&this.ensureAuthenticatedClient(),this.github.repo.get("issues",{params:{labels:this.config.label}}).then(function(e){if(!e.data.length)throw new Error("Could not find an open issue labeled: "+o.config.label);var n=void 0;if(""===o.config.issueNumber)n=e.data[0];else if(void 0===(n=e.data.find(function(e){return e.number===parseInt(o.config.issueNumber)})))throw new Error("Could not find an open issue labeled: "+o.config.label+" and numbered: "+o.config.issueNumber);t.onHelpText(n.body),o.issueNumber=n.number}).then(function(){return o.pollIssueForComments()}).catch(function(e){return o.reportError(e)})}return s()(e,[{key:"postNewProject",value:function(e){var t=this;return this.ensureAuthenticatedClient().then(function(){var o=u.a.serializeProjectToComment(e);return t.github.repo.post("issues/"+t.issueNumber+"/comments",{body:o})}).then(function(e){return u.a.deserializeCommentToProject(e.data)})}},{key:"updateProject",value:function(e){var t=this;return this.ensureAuthenticatedClient().then(function(){var o=u.a.serializeProjectToComment(e);return t.github.repo.patch("issues/comments/"+e.id,{body:o})}).then(function(e){return u.a.deserializeCommentToProject(e.data)})}},{key:"deleteProject",value:function(e){var t=this;return this.ensureAuthenticatedClient().then(function(){return t.github.repo.delete("issues/comments/"+e)})}},{key:"pollIssueForComments",value:function(){var e,t=this,o="issues/"+this.issueNumber+"/comments",n=function(){return console.log("polling..."),t.github.repo.get(o,{headers:e?{"If-None-Match":e}:{}}).then(function(o){if(200===o.status){e=o.headers.etag;var n=o.data.map(u.a.deserializeCommentToProject);t.config.onProjectsUpdated(n)}}).catch(function(e){return t.reportError(e)})};return window.setInterval(n,1e3*this.config.pollIntervalSeconds),n()}},{key:"ensureAuthenticatedClient",value:function(){var e=this;return this.config.onAuthenticationRequired().then(function(t){if(!e.github.isAuthenticated)return e.github=e.createGithubApiClient(e.config.organization,e.config.repository,t),e.github.isAuthenticated=!0,e.github.get("user")}).then(function(t){t&&e.config.onUserAuthenticated(t)})}},{key:"deauthenticateClient",value:function(){d.a.logOut(),this.github=this.createGithubApiClient(this.config.organization,this.config.repository)}},{key:"createGithubApiClient",value:function(e,t,o){function n(e){var t={baseURL:"https://api.github.com/"+(e||"")};return o&&(t.headers={Authorization:"token "+o}),t}var i=c.a.create(n());return i.repo=c.a.create(n("repos/"+e+"/"+t+"/")),i}},{key:"reportError",value:function(e){console.log(e)}}]),e}();t.a=l},68:function(e,t,o){"use strict";function n(e){var t=e.slice(-1)[0],o=i.exec(t);return o?{x:o[1],y:o[2]}:{x:0,y:0}}var i=/<!-- ([.\d]+),([.\d]+) -->/;t.a={deserializeCommentToProject:function(e){var t=e.body.split("\r\n"),o=n(t);return{id:e.id,title:t[0],description:t[1],username:e.user.login,userId:e.user.id,avatar_thumbnail:e.user.avatar_url+"&s=40",avatar:e.user.avatar_url+"&s=120",x:o.x,y:o.y,editMode:!1}},serializeProjectToComment:function(e){return e.title+"\r\n"+(e.description||"")+"\r\n\x3c!-- "+e.x+","+e.y+" --\x3e"}}},69:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(25),i=o(49),r=o.n(i),s=o(48);n.a.config.productionTip=!1,new n.a({el:"#app",router:s.a,template:"<App/>",components:{App:r.a}})},70:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"app"}},71:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"center",props:["helpText","username","projects","selectedProject","mapWidth","mapHeight"],methods:{dragover:function(e){this.$emit("dragover",e),e.preventDefault(),e.dataTransfer.dropEffect="copy"},drag:function(e){var t=e.target.dataset.id;e.dataTransfer.setData("projectId",t)},drop:function(e){this.$emit("drop",e)},login:function(){this.$emit("login")},logout:function(){this.$emit("logout")},updateSelectedProject:function(e){this.$emit("updateSelectedProject",e)}},beforeDestroy:function(){window.removeEventListener("resize",this.updateMapDimensions)}}},72:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(67),i=o(32),r=o(125),s=o.n(r),a=o(123),c=o.n(a),u=o(126),d=o.n(u),l=void 0;t.default={name:"hackmap",props:{issueNumber:{default:"",type:String}},data:function(){return{helpText:"",projects:[],mapWidth:0,mapHeight:0,form:{isOpen:!1,title:"",description:""},authenticationUrl:"",username:"",userId:"",isHasIssue:!1,selectedProject:{id:"",avatar:"",username:"",editMode:"",title:"",description:""}}},methods:{toggleForm:function(){var e=this;return this.form.isOpen?(this.form.title=this.form.title.trim(),this.form.description=this.form.description.trim(),this.form.title||this.form.description?this.form.title?(l.postNewProject(this.form).then(function(t){e.projects.push(t),e.form.title="",e.form.description=""}).catch(function(e){return console.error(e)}),void(this.form.isOpen=!1)):void alert("Please enter a topic for your project"):void(this.form.isOpen=!1)):void(this.form.isOpen=!0)},leftDrag:function(e){var t=e.target.querySelector("img");e.dataTransfer.setDragImage(t,20,20);var o=e.target.dataset.id;e.dataTransfer.setData("projectId",o)},updateSelectedProject:function(e){this.selectedProject=e},centerDrop:function(e){var t=e.dataTransfer.getData("projectId"),o=this.projects.filter(function(e){return e.id===parseInt(t)})[0];this.updateMapDimensions();var n=o.x,i=o.y;o.x=e.offsetX/this.mapWidth,o.y=e.offsetY/this.mapHeight,l.updateProject(o).catch(function(e){console.log("update rejected",e),o.x=n,o.y=i})},updateMapDimensions:function(){var e=this.$el.querySelector(".floorplan");this.mapWidth=e.clientWidth,this.mapHeight=e.clientHeight},login:function(){l.ensureAuthenticatedClient().then(function(e){return console.log(e)})},logout:function(){this.username="",l.deauthenticateClient()},toggleEditMode:function(){this.selectedProject.editMode?(this.selectedProject.title=this.selectedProject.backup.title,this.selectedProject.description=this.selectedProject.backup.description):this.selectedProject.backup={title:this.selectedProject.title,description:this.selectedProject.description},this.selectedProject.editMode=!this.selectedProject.editMode},updateProject:function(){var e=this;l.updateProject(this.selectedProject).then(function(){e.selectedProject.editMode=!1}).catch(function(t){console.log("update rejected",t);var o=e.selectedProject.backup;e.selectedProject.title=o.title,e.selectedProject.description=o.description})},deleteProject:function(e){var t=this;l.deleteProject(e).then(function(){t.selectedProject={id:"",avatar:"",username:"",editMode:"",title:"",description:""};var o=t.projects.findIndex(function(t){return t.id===e});t.projects.splice(o,1)})}},components:{Left:s.a,Center:c.a,Right:d.a},mounted:function(){var e=this;l=new n.a({organization:"bkkhack",repository:"hackmap",label:"BKKHack Main Thread",onAuthenticationRequired:i.a.getOAuthToken,pollIntervalSeconds:60,onProjectsUpdated:function(t){e.projects=t,void 0!==e.projects.find(function(t){return t.userId===e.userId})&&(e.isHasIssue=!0)},onHelpText:function(t){e.helpText=t},onUserAuthenticated:function(t){e.username=t.data.login,e.userId=t.data.id},issueNumber:this.issueNumber}),this.$el.querySelector(".floorplan").addEventListener("load",this.updateMapDimensions),this.updateMapDimensions(),window.addEventListener("resize",this.updateMapDimensions)}}},73:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"left",props:["form","projects","selectedProject","username","isHasIssue"],methods:{toggleForm:function(){this.$emit("toggleForm")},drag:function(e){this.$emit("drag",e)},updateSelectedProject:function(e){this.$emit("updateSelectedProject",e)}}}},74:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"right",props:["selectedProject","username"],methods:{toggleEditMode:function(){this.$emit("toggleEditMode")},updateProject:function(){this.$emit("updateProject")},deleteComment:function(e){this.$emit("deleteProject",e)}}}}},[69]);
//# sourceMappingURL=app.393f43f5cf1222bed737.js.map